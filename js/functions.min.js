jQuery(document).ready(function() {
    jQuery(function() {
        jQuery(".nav-prev").click(function() {
            location.href = jQuery(this).attr("href")
        }), jQuery(".nav-next").click(function() {
            location.href = jQuery(this).attr("href")
        }), jQuery(".toggleButton").click(function(e) {
            e.preventDefault(); 

            var parent = $(this).parent().parent("li");
            var children = parent.children("ul");

            if (children.hasClass( "hidden" )) {
                children.removeClass( "hidden" );
                $(this).children(".right").addClass( "hidden" );
                $(this).children(".down").removeClass( "hidden" );
            } else {
                children.addClass( "hidden" );
                $(this).children(".right").removeClass( "hidden" );
                $(this).children(".down").addClass( "hidden" );
            }
        })
    }), jQuery(document).keydown(function(n) {
        "37" == n.which && jQuery(".nav.nav-prev").click(), "39" == n.which && jQuery(".nav.nav-next").click()
    })

    console.log("ready")
    // If the page is ready, open the sub menu for the current page
    var current_url = $(location).attr('href')
    var element = $("a[href='" + current_url + "']")
    //console.log(element.prop('tagName'));
    //console.log(element.attr('href'));
    var toggleButton = element.children(".toggleButton")

    var parent = element.parent();
    //console.log("parent: " +  parent);
    if (parent.hasClass( "has-sub-menu" )) {
        var children = parent.children("ul");
        //console.log("children: " +  children);

        children.removeClass( "hidden" );
        toggleButton.children(".right").addClass( "hidden" );
        toggleButton.children(".down").removeClass( "hidden" );

        /*
        if (children.hasClass( "hidden" )) {
            console.log("children.hasClass( hidden )");
            children.removeClass( "hidden" );
            toggleButton.children(".right").addClass( "hidden" );
            toggleButton.children(".down").removeClass( "hidden" );
        } else {
            console.log("children.hasClass( hidden ) - false");
            children.addClass( "hidden" );
            toggleButton.children(".right").removeClass( "hidden" );
            toggleButton.children(".down").addClass( "hidden" );
        }
        */
    }        

});
